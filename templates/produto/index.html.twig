{% extends 'base.html.twig' %}
{% block title %}Cadastro de Produtos{% endblock %}
{% block body %}
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js" integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI" crossorigin="anonymous"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">

    <style>
        .example-wrapper { margin: 1em auto; max-width: 800px; width: 95%; font: 18px/1.5 sans-serif; }
        .example-wrapper code { padding: 2px 6px; }
        .table th, .table td { vertical-align: middle; }
    </style>

    <div class="example-wrapper">
        <h1>Cadastro de Produto</h1>
        <hr />

        <h2>Formulário de Cadastro</h2>
        <form action="{{ path('produto_novo') }}" method="post" class="needs-validation" novalidate>
            <div class="mb-3">
                <label for="nameProduto" class="form-label">Nome do Produto</label>
                <input type="text" class="form-control" id="nameProduto" name="nameProduto" placeholder="Digite o nome do produto" value="{{ produto.nameProduto|default('') }}" required>
                {% if errors.nameProduto is defined %}
                    <div class="invalid-feedback d-block">{{ errors.nameProduto }}</div>
                {% endif %}
            </div>
            <div class="mb-3">
                <label for="preco" class="form-label">Preço</label>
                <input type="number" class="form-control" id="preco" name="preco" placeholder="Digite o preço" step="0.01" value="{{ produto.preco|default('') }}">
                {% if errors.preco is defined %}
                    <div class="invalid-feedback d-block">{{ errors.preco }}</div>
                {% endif %}
            </div>
            <div class="mb-3">
                <label for="estoque" class="form-label">Estoque</label>
                <input type="number" class="form-control" id="estoque" name="estoque" placeholder="Digite a quantidade em estoque" value="{{ produto.estoque|default('') }}" required>
                {% if errors.estoque is defined %}
                    <div class="invalid-feedback d-block">{{ errors.estoque }}</div>
                {% endif %}
            </div>
            {% if produto.idProduto is defined %}
                <input type="hidden" name="idProduto" value="{{ produto.idProduto }}">
            {% endif %}
            <button class="btn btn-outline-success" type="submit">Salvar</button>
        </form>

        <hr />

        <h2>Lista de Produtos</h2>
        {% if produtos|length > 0 %}
            <table class="table table-striped">
                <thead>
                    <tr>
                        <th>Nome do Produto</th>
                        <th>Preço</th>
                        <th>Estoque</th>
                        <th>Ações</th>
                    </tr>
                </thead>
                <tbody>
                    {% for item in produtos %}
                        <tr>
                            <td>{{ item.nameProduto }}</td>
                            <td>R$ {{ item.preco|number_format(2, ',', '.') }}</td>
                            <td>{{ item.estoque }}</td>
                            <td>
                                <a href="{{ path('produto_edit', {'idProduto': item.idProduto}) }}" class="btn btn-sm btn-outline-success">Editar</a>
                                <a href="{{ path('produto_delete', {'idProduto': item.idProduto}) }}" class="btn btn-sm btn-outline-danger" onclick="return confirm('Tem certeza que deseja excluir este produto?')">Excluir</a>
                            </td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        {% else %}
            <p>Nenhum produto cadastrado.</p>
        {% endif %}
    </div>
{% endblock %}